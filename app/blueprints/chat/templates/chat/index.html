{% extends "base.html" %}

{% block content %}
<div class="app-container">
    <!-- –®–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <header class="app-header">
        <h1>MakarTXT</h1>
        <div class="header-buttons">
            <button id="history-btn" class="header-btn">–ò—Å—Ç–æ—Ä–∏—è</button>
            <button id="files-btn" class="header-btn active">–§–∞–π–ª—ã</button>
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
    <main class="content-area">
        <!-- –ë–ª–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div id="history-panel" class="panel">
            <div class="messages-container" id="messages-container">
                {% for msg in messages %}
                <div class="message {% if msg.type == 'text' %}user{% endif %}">
                    {% if msg.type == 'text' %}
                        <div class="message-content">{{ msg.content }}</div>
                    {% else %}
                        <div class="file-item">
                            <span class="file-icon">üìÑ</span>
                            <div class="file-info">
                                <div class="file-name">{{ msg.filename }}</div>
                                <div class="file-meta">
                                    <span>{{ msg.time }}</span>
                                    <span class="file-size">{{ (msg.size/1024)|round(2) }} KB</span>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                    <span class="message-time">{{ msg.time }}</span>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- –ë–ª–æ–∫ —Ñ–∞–π–ª–æ–≤ -->
        <div id="files-panel" class="panel hidden">
            <div class="file-actions">
                <button id="refresh-files" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
                <input type="file" id="file-input" multiple style="display: none;">
                <button id="upload-btn" class="action-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            </div>
            <div class="files-list" id="files-list">
                <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </main>

    <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ -->
    <footer class="input-area">
        <div class="input-area">
            <div class="input-container">
                <textarea 
                    id="message-input"
                    class="text-input"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                    rows="1"></textarea>
                <button id="send-btn" class="btn btn-primary">
                    <span class="send-icon">‚û§</span>
                </button>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content">
            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª?</p>
            <div class="modal-buttons">
                <button id="confirm-delete">–î–∞</button>
                <button id="cancel-delete">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="actions-panel hidden" id="actions-panel">
        <div class="form-group">
            <label for="file-input" class="btn btn-block file-upload-btn">
                üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
            </label>
        </div>
        
        <div class="form-group youtube-group">
            <input type="text" 
                   id="youtube-url" 
                   class="form-control" 
                   placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ YouTube">
            <button id="youtube-download" class="btn btn-block youtube-btn">
                üé¨ –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ
            </button>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é -->
    <button id="menu-button" class="menu-button">‚ãÆ</button>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—å—é –¥–µ–π—Å—Ç–≤–∏–π
    const menuButton = document.getElementById('menu-button');
    const actionsPanel = document.getElementById('actions-panel');
    
    if (menuButton && actionsPanel) {
        menuButton.addEventListener('click', function() {
            actionsPanel.classList.toggle('hidden');
        });
    }

    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤—ã—Å–æ—Ç—ã —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
    const textInput = document.getElementById('message-input');
    if (textInput) {
        textInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });
    }
});
</script>
{% endblock %}